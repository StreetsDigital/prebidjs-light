###############################################################################
# pbjs_engine API Server Configuration
# Copy this file to .env and update values for your environment
###############################################################################

# ─── Server Configuration ────────────────────────────────────────────────────

# Environment: development | production | test
# Affects logging, error messages, and security features
NODE_ENV=development

# Server host (0.0.0.0 allows external connections, localhost for local only)
API_HOST=0.0.0.0

# Port for API server to listen on
API_PORT=3001

# Log level: fatal | error | warn | info | debug | trace
# Use 'info' for production, 'debug' for development
LOG_LEVEL=info

# ─── Authentication & Security ───────────────────────────────────────────────

# JWT Secret (REQUIRED) - Use a strong random string (at least 32 characters)
# Generate with: openssl rand -base64 32
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production

# Cookie Secret (REQUIRED) - Use a strong random string (at least 32 characters)
# Generate with: openssl rand -base64 32
COOKIE_SECRET=your-super-secret-cookie-key-change-this-in-production

# ─── Database Configuration ──────────────────────────────────────────────────

# Path to SQLite database file (relative to apps/api/)
# Production: Use absolute path like /var/lib/pbjs_engine/pbjs_engine.db
DATABASE_PATH=./data/pbjs_engine.db

# ─── CORS (Cross-Origin Resource Sharing) ────────────────────────────────────

# Allowed origins for CORS (comma-separated list)
# Production: Set to your actual frontend domain(s)
# Development: Include localhost ports for frontend dev server
ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000

# ─── Super Admin Credentials ─────────────────────────────────────────────────

# Super admin email (used by db:seed-admin script)
SUPER_ADMIN_EMAIL=admin@thenexusengine.com

# Super admin password (used by db:seed-admin script)
# Production: Change immediately after first login
SUPER_ADMIN_PASSWORD=ChangeMe123!

# Super admin name (used by db:seed-admin script)
SUPER_ADMIN_NAME=Super Admin

# Auto-seed super admin on first server start
# Set to 'true' for initial setup, 'false' for production
AUTO_SEED_ADMIN=false

# ─── Prebid.js Build System ──────────────────────────────────────────────────

# Directory where Prebid.js source is cloned (relative to apps/api/)
# The build system will clone Prebid.js here if it doesn't exist
PREBID_SOURCE_DIR=./prebid-source

# Directory where built Prebid.js bundles are stored (relative to apps/api/)
PREBID_BUILD_DIR=./prebid-builds

# ─── Analytics & Monitoring ──────────────────────────────────────────────────

# ClickHouse host (for analytics data storage)
# Leave empty to disable ClickHouse integration
CLICKHOUSE_HOST=

# ClickHouse database name
CLICKHOUSE_DATABASE=pbjs_engine

# ClickHouse username
CLICKHOUSE_USER=default

# ClickHouse password
CLICKHOUSE_PASSWORD=

# ─── Redis Configuration ─────────────────────────────────────────────────────

# Redis host (for caching and rate limiting)
# Leave empty to use in-memory caching (not recommended for production)
REDIS_HOST=

# Redis port
REDIS_PORT=6379

# Redis password
REDIS_PASSWORD=

# Redis database number (0-15)
REDIS_DB=0

# ─── Feature Flags ───────────────────────────────────────────────────────────

# Enable experimental features
ENABLE_EXPERIMENTAL_FEATURES=false

# Enable debug mode (verbose logging, detailed errors)
ENABLE_DEBUG_MODE=false

# ─── External Services ───────────────────────────────────────────────────────

# Email service for notifications (future feature)
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@pbjs-engine.com

# ─── Performance & Limits ────────────────────────────────────────────────────

# Maximum JSON request body size (in bytes)
# Default: 1MB
MAX_JSON_SIZE=1048576

# Request timeout (in milliseconds)
# Default: 30 seconds
REQUEST_TIMEOUT=30000

# ─── Production Notes ────────────────────────────────────────────────────────

# IMPORTANT: In production, ensure you:
# 1. Change all secrets (JWT_SECRET, COOKIE_SECRET)
# 2. Use strong super admin password and change it immediately
# 3. Set ALLOWED_ORIGINS to your actual frontend domain(s)
# 4. Use absolute paths for database and build directories
# 5. Set NODE_ENV=production
# 6. Configure external Redis for caching (recommended)
# 7. Configure ClickHouse for analytics (optional)
# 8. Set up SSL/TLS termination (use reverse proxy like nginx)
# 9. Enable firewall and restrict API_HOST if needed
# 10. Set up database backups (use scripts/backup-database.sh)
